import{a as N,p as k,h as I,q as E}from"./index-DDgcFCyj.js";import{R as y}from"./router-CtMSw6XR.js";const A=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],$=N("plus",A),O=n=>{let a;const e=new Set,t=(u,d)=>{const g=typeof u=="function"?u(a):u;if(!Object.is(g,a)){const D=a;a=d??(typeof g!="object"||g===null)?g:Object.assign({},a,g),e.forEach(v=>v(a,D))}},r=()=>a,c={setState:t,getState:r,getInitialState:()=>l,subscribe:u=>(e.add(u),()=>e.delete(u))},l=a=n(t,r,c);return c},M=(n=>n?O(n):O),T=n=>n;function B(n,a=T){const e=y.useSyncExternalStore(n.subscribe,y.useCallback(()=>a(n.getState()),[n,a]),y.useCallback(()=>a(n.getInitialState()),[n,a]));return y.useDebugValue(e),e}const x=n=>{const a=M(n),e=t=>B(a,t);return Object.assign(e,a),e},G=(n=>n?x(n):x);function H(n,a){let e;try{e=n()}catch{return}return{getItem:r=>{var s;const m=l=>l===null?null:JSON.parse(l,void 0),c=(s=e.getItem(r))!=null?s:null;return c instanceof Promise?c.then(m):m(c)},setItem:(r,s)=>e.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>e.removeItem(r)}}const _=n=>a=>{try{const e=n(a);return e instanceof Promise?e:{then(t){return _(t)(e)},catch(t){return this}}}catch(e){return{then(t){return this},catch(t){return _(t)(e)}}}},j=(n,a)=>(e,t,r)=>{let s={storage:H(()=>window.localStorage),partialize:i=>i,version:0,merge:(i,p)=>({...p,...i}),...a},m=!1,c=0;const l=new Set,u=new Set;let d=s.storage;if(!d)return n((...i)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),e(...i)},t,r);const g=()=>{const i=s.partialize({...t()});return d.setItem(s.name,{state:i,version:s.version})},D=r.setState;r.setState=(i,p)=>(D(i,p),g());const v=n((...i)=>(e(...i),g()),t,r);r.getInitialState=()=>v;let f;const C=()=>{var i,p;if(!d)return;const b=++c;m=!1,l.forEach(o=>{var S;return o((S=t())!=null?S:v)});const h=((p=s.onRehydrateStorage)==null?void 0:p.call(s,(i=t())!=null?i:v))||void 0;return _(d.getItem.bind(d))(s.name).then(o=>{if(o)if(typeof o.version=="number"&&o.version!==s.version){if(s.migrate){const S=s.migrate(o.state,o.version);return S instanceof Promise?S.then(P=>[!0,P]):[!0,S]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,o.state];return[!1,void 0]}).then(o=>{var S;if(b!==c)return;const[P,w]=o;if(f=s.merge(w,(S=t())!=null?S:v),e(f,!0),P)return g()}).then(()=>{b===c&&(h?.(f,void 0),f=t(),m=!0,u.forEach(o=>o(f)))}).catch(o=>{b===c&&h?.(void 0,o)})};return r.persist={setOptions:i=>{s={...s,...i},i.storage&&(d=i.storage)},clearStorage:()=>{d?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>C(),hasHydrated:()=>m,onHydrate:i=>(l.add(i),()=>{l.delete(i)}),onFinishHydration:i=>(u.add(i),()=>{u.delete(i)})},s.skipHydration||C(),f||v},L=j,R={currentStep:0,occasion:"",recipientRelationship:"",recipientName:"",recipientInterests:[],budget:50,boxSize:"M",packagingStyle:"classic",themePalette:"rose",themePattern:"none",selectedItems:[],includeCard:!0,cardTone:"",cardMessage:"",deliveryName:"",deliveryAddress:"",deliveryCity:"",deliveryZip:"",deliveryCountry:"",deliveryDate:"",deliveryNotes:"",orderPlaced:!1},F=9,z=G()(L((n,a)=>({state:{...R},savedDesigns:[],setState:e=>n(t=>({state:{...t.state,...e}})),setStep:e=>n(t=>({state:{...t.state,currentStep:e}})),nextStep:()=>n(e=>({state:{...e.state,currentStep:Math.min(e.state.currentStep+1,F-1)}})),prevStep:()=>n(e=>({state:{...e.state,currentStep:Math.max(e.state.currentStep-1,0)}})),addItem:e=>n(t=>{const r=I.BOX_SIZES[t.state.boxSize].maxItems;return t.state.selectedItems.length>=r||t.state.selectedItems.find(s=>s.id===e.id)?t:{state:{...t.state,selectedItems:[...t.state.selectedItems,e]}}}),removeItem:e=>n(t=>({state:{...t.state,selectedItems:t.state.selectedItems.filter(r=>r.id!==e)}})),resetBuilder:()=>n({state:{...R}}),saveDesign:e=>{const t=E(),r={id:t,name:e||`Gift Box ${new Date().toLocaleDateString()}`,savedAt:new Date().toISOString(),state:{...a().state}};return n(s=>({savedDesigns:[...s.savedDesigns,r]})),t},loadDesign:e=>{const t=a().savedDesigns.find(r=>r.id===e);t&&n({state:{...t.state}})},deleteDesign:e=>n(t=>({savedDesigns:t.savedDesigns.filter(r=>r.id!==e)})),renameDesign:(e,t)=>n(r=>({savedDesigns:r.savedDesigns.map(s=>s.id===e?{...s,name:t}:s)})),duplicateDesign:e=>{const t=a().savedDesigns.find(r=>r.id===e);if(t){const r={...t,id:E(),name:`${t.name} (Copy)`,savedAt:new Date().toISOString()};n(s=>({savedDesigns:[...s.savedDesigns,r]}))}},getTotalPrice:()=>{const{state:e}=a(),t=I.BOX_SIZES[e.boxSize].basePrice,r=e.selectedItems.reduce((c,l)=>c+l.price,0),s=I.PACKAGING[e.packagingStyle].multiplier,m=e.includeCard?I.CARD_PRICE:0;return Math.round((t+r)*s+m)}}),{name:k.SAVED_DESIGNS,partialize:n=>({savedDesigns:n.savedDesigns})}));export{$ as P,F as T,z as u};
